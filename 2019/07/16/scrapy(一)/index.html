<!DOCTYPE html>
<html>

<head><meta name="generator" content="Hexo 3.9.0">
  
  <title>Scrapy - Scorpio</title>
  <meta charset="UTF-8">
  <meta name="description" content="每个人都应该拥有自己的梦想">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  

  <link rel="shortcut icon" href="https://s2.ax1x.com/2019/08/27/m5XhWT.jpg" type="image/png">
  <meta name="description" content="scrapy，了解一下">
<meta name="keywords" content="python,scrapy">
<meta property="og:type" content="article">
<meta property="og:title" content="Scrapy">
<meta property="og:url" content="https://www.Gsuhy.cn/2019/07/16/scrapy(一)/index.html">
<meta property="og:site_name" content="Scorpio">
<meta property="og:description" content="scrapy，了解一下">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-08-27T07:02:21.592Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Scrapy">
<meta name="twitter:description" content="scrapy，了解一下">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdui@0.4.3/dist/css/mdui.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.15.8/styles/atom-one-dark.css">
   
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1038733_0xvrvpg9c0r.css">
  <link rel="stylesheet" href="/css/style.css?v=1566921989031">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>

<body class="mdui-drawer-body-left">
  
  <div id="nexmoe-background">
    <div class="nexmoe-bg" style="background-image: url(http://tva1.sinaimg.cn/large/007X8olVly1g6ebo1zs56j31df0u0tvf.jpg)"></div>
    <div class="mdui-appbar mdui-shadow-0">
      <div class="mdui-toolbar">
        <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">menu</i></a>
        <div class="mdui-toolbar-spacer"></div>
        <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
        <a href="/" title="Gsuhy" class="mdui-btn mdui-btn-icon"><img src="https://s2.ax1x.com/2019/08/27/m5XhWT.jpg"></a>
       </div>
    </div>
  </div>
  <div id="nexmoe-header">
      <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="Gsuhy">
            <img src="https://s2.ax1x.com/2019/08/27/m5XhWT.jpg" alt="Gsuhy">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>30</div>
        <div><span>标签</span>15</div>
        <div><span>分类</span>13</div>
    </div>
    <ul class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/about.html" title="关于博客">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                关于博客
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/PY.html" title="我的朋友">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
    </ul>
    <aside id="nexmoe-sidebar">
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">社交按钮</h3>
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://space.bilibili.com/20238211" target="_blank" mdui-tooltip="{content: '哔哩哔哩'}" style="color: rgb(231, 106, 141);background-color: rgba(231, 106, 141, .15);">
            <i class="nexmoefont icon-bilibili"></i>
        </a><a class="mdui-ripple" href="https://github.com/mGsuhy" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a>
    </div>
</div>
  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/CTF/">CTF</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JAVA/">JAVA</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JSP/">JSP</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Link/">Link</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Linux/">Linux</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Nginx/">Nginx</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/PHP/">PHP</a>
          <span class="category-list-count">4</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Python/">Python</a>
          <span class="category-list-count">11</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/SQL/">SQL</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/内网渗透/">内网渗透</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/前端/">前端</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/学习/">学习</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/生活/">生活</a>
          <span class="category-list-count">1</span>
        </li>

        
      </ul>

    </div>
  </div>


  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">标签云</h3>
    <div id="randomtagcloud" class="nexmoe-widget tagcloud">
      <a href="/tags/CTF/" style="font-size: 12.5px;">CTF</a> <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/Nginx/" style="font-size: 12.5px;">Nginx</a> <a href="/tags/PHP/" style="font-size: 17.5px;">PHP</a> <a href="/tags/WP/" style="font-size: 10px;">WP</a> <a href="/tags/jSP/" style="font-size: 10px;">jSP</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/php/" style="font-size: 10px;">php</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/scrapy/" style="font-size: 10px;">scrapy</a> <a href="/tags/sites/" style="font-size: 10px;">sites</a> <a href="/tags/sql/" style="font-size: 15px;">sql</a> <a href="/tags/内网渗透/" style="font-size: 10px;">内网渗透</a> <a href="/tags/生活/" style="font-size: 10px;">生活</a>
    </div>
    
  </div>

  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章归档</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a></li></ul>
    </div>
  </div>


  
</aside>
    <div class="nexmoe-copyright">
        &copy; 2019 Gsuhy
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://nexmoe.com/hexo-theme-nexmoe.html" target="_blank">Nexmoe</a>
    </div>
</div><!-- .nexmoe-drawer -->
  </div>
  <div id="nexmoe-content">
    <div class="nexmoe-primary">
        <div class="nexmoe-post">
    <div class="nexmoe-post-cover"> 
        
            <img src="http://tva1.sinaimg.cn/large/007X8olVly1g6ebo1zs56j31df0u0tvf.jpg">
        
        <h1>Scrapy</h1>
    </div>
  <div class="nexmoe-post-meta">
    <a><i class="nexmoefont icon-calendar-fill"></i>2019年07月16日</a>
    <a><i class="nexmoefont icon-areachart"></i>2.5k 字</a>
    <a><i class="nexmoefont icon-time-circle-fill"></i>大概 11 分钟</a>
    
      <a class="nexmoefont icon-appstore-fill -link" href="/categories/Python/">Python</a>
    
    
      <a class="nexmoefont icon-tag-fill -link" href="/tags/python/">python</a> <a class="nexmoefont icon-tag-fill -link" href="/tags/scrapy/">scrapy</a>
    
  </div>
  <article>
    <p>scrapy，了解一下<a id="more"></a></p>
<h1 id="Scrapy之路-一"><a href="#Scrapy之路-一" class="headerlink" title="Scrapy之路(一)"></a>Scrapy之路(一)</h1><p>前面安装什么的我就不说了，一大堆坑，坑了我两天才终于把Scrapy安装好，踩的坑网上都有怎么填我就不详细说了。开始正文学习。</p>
<h2 id="全局命令"><a href="#全局命令" class="headerlink" title="全局命令"></a>全局命令</h2><h3 id="startprojiect"><a href="#startprojiect" class="headerlink" title="startprojiect"></a>startprojiect</h3><p>语法：<code>scrapy startproject &lt;projectname&gt;</code><br>在当前目录下创建一个自己命名的scrapy项目</p>
<h3 id="settings"><a href="#settings" class="headerlink" title="settings"></a>settings</h3><p>语法：<code>scrapy setting [options]</code><br>运行一些设定</p>
<h3 id="runspider"><a href="#runspider" class="headerlink" title="runspider"></a>runspider</h3><p>语法：<code>scrapy runspider &lt;spiderfile.py&gt;</code><br>在未创建项目的情况下，运行一个编写在python文件中的spider</p>
<h3 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h3><p>语法：<code>scrapy shell [url]</code><br>启动<code>Scrpy shell</code>,如果给定url就运行指定的url，如果没有就只启动交互式命令行</p>
<h3 id="fetch"><a href="#fetch" class="headerlink" title="fetch"></a>fetch</h3><p>语法：<code>scrapy fetch &lt;url&gt;</code><br>使用Scrapy下载器下载给定的url，并且将获取的内容输出。也就是打印url 的html代码。</p>
<h3 id="view"><a href="#view" class="headerlink" title="view"></a>view</h3><p>语法：<code>scrapy view &lt;url&gt;</code><br>在你的默认浏览器中打开给定的URL，并以Scrapy spider获取到的形式展现。 有些时候spider获取到的页面和普通用户看到的并不相同，一些动态加载的内容是看不到的， 因此该命令可以用来检查spider所获取到的页面。</p>
<h3 id="version"><a href="#version" class="headerlink" title="version"></a>version</h3><p>语法：<code>scrapy version [-v]</code><br>输出scrapy的版本</p>
<h2 id="项目命令"><a href="#项目命令" class="headerlink" title="项目命令"></a>项目命令</h2><h3 id="crawl"><a href="#crawl" class="headerlink" title="crawl"></a>crawl</h3><p>语法:：<code>scrapy crawl &lt;spider_name&gt;</code><br>使用你项目中的spider进行爬取，即启动你的项目。这个命令将会经常用到，我们会在后面的内容中经常使用。</p>
<h3 id="check"><a href="#check" class="headerlink" title="check"></a>check</h3><p>语法:：<code>crapy check [-l] &lt;spider&gt;</code><br>运行contract检查，检查你项目中的错误之处。</p>
<h3 id="list"><a href="#list" class="headerlink" title="list"></a>list</h3><p>语法：<code>scrapy list</code><br>列出当前项目中所有可用的spider。每行输出一个spider。</p>
<h3 id="genspider"><a href="#genspider" class="headerlink" title="genspider"></a>genspider</h3><p>语法：<code>scrapy genspider [-t template] &lt;name&gt; &lt;domain&gt;</code><br>在当前项目中创建spider。该方法可以使用提前定义好的模板来生成spider。您也可以自己创建spider的源码文件。</p>
<h2 id="Spiders"><a href="#Spiders" class="headerlink" title="Spiders"></a>Spiders</h2><p>Spider类定义了如何爬取某个网站。包括了爬取的动作(比如是否跟进链接)以及如何从网页的内容中提取结构化数据(爬取item)。也就是说，Spider是定义爬取的动作和分析某个网页的地方。<br>大致工作流程是这样的：</p>
<ul>
<li>以初始的URL初始化Request,并设置回调函数，当该request下载完毕并返回时，将生成response，并作为参数传给回调函数，spider中初始的request是通过<code>start_requests()</code>来获取。<code>start_requests()</code>获取<code>start_urls</code>中的url，并以parse以回调函数生成request</li>
<li>在回调函数内分析返回的网页内容，可以返回item对象，或者dict或者request，以及是一个包含三者的可迭代的容器，返回的request对象之后会经过scrapy处理，下载相应的内容，并调用设置的callback函数</li>
<li>在回调函数内，可以通过lxml,bs4,xpath,css等方法获取想要的内容生成item</li>
<li>最后将Item传递给pipeline处理</li>
</ul>
<p>在运行<code>crawl</code>的时候可以添加<code>-a</code>传递spider参数。<br><code>scrapy crawl myspider -a category=electronics</code></p>
<p>spider在构造器(constructor)中获取参数:</p>
<pre><code>import scrapy

class MySpider(Spider):
    name = &#39;myspider&#39;

    def __init__(self, category=None, *args, **kwargs):
        super(MySpider, self).__init__(*args, **kwargs)
        self.start_urls = [&#39;http://www.example.com/categories/%s&#39; % category]</code></pre><h3 id="name"><a href="#name" class="headerlink" title="name"></a>name</h3><p>定义spider名字的字符串(string)。spider的名字定义了Scrapy如何定位(并初始化)spider，所以其必须是唯一的。 不过您可以生成多个相同的spider实例(instance)，这没有任何限制。 name是spider最重要的属性，而且是必须的。</p>
<p>如果该spider爬取单个网站(single domain)，一个常见的做法是以该网站(domain)(加或不加 后缀 )来命名spider。 例如，如果spider爬取 mywebsite.com ，该spider通常会被命名为 mywebsite 。</p>
<h3 id="allowed-domains"><a href="#allowed-domains" class="headerlink" title="allowed_domains"></a>allowed_domains</h3><p>可选。包含了spider允许爬取的域名(domain)列表(list)。 当 OffsiteMiddleware 启用时， 域名不在列表中的URL不会被跟进。</p>
<h3 id="start-urls"><a href="#start-urls" class="headerlink" title="start_urls"></a>start_urls</h3><p>URL列表。当没有制定特定的URL时，spider将从该列表中开始进行爬取。 因此，第一个被获取到的页面的URL将是该列表之一。 后续的URL将会从获取到的数据中提取。</p>
<h3 id="start-requests"><a href="#start-requests" class="headerlink" title="start_requests()"></a>start_requests()</h3><p>该方法必须返回一个可迭代对象(iterable)。该对象包含了spider用于爬取的第一个Request。<br>当spider启动爬取并且未制定URL时，该方法被调用。 当指定了URL时，make_requests_from_url() 将被调用来创建Request对象。 该方法仅仅会被Scrapy调用一次，因此您可以将其实现为生成器。<br>该方法的默认实现是使用 start_urls 的url生成Request。</p>
<h3 id="parse-response"><a href="#parse-response" class="headerlink" title="parse(response)"></a>parse(response)</h3><p>当response没有指定回调函数时，该方法是Scrapy处理下载的response的默认方法。<br>parse 负责处理response并返回处理的数据以及(/或)跟进的URL。 Spider 对其他的Request的回调函数也有相同的要求。<br>该方法及其他的Request回调函数必须返回一个包含 Request 及(或) Item 的可迭代的对象。<br>参数:    <code>response (Response)</code> – 用于分析的response</p>
<h3 id="closed-reason"><a href="#closed-reason" class="headerlink" title="closed(reason)"></a>closed(reason)</h3><p>当spider关闭时，该函数被调用。</p>
<h2 id="Selector-选择器"><a href="#Selector-选择器" class="headerlink" title="Selector 选择器"></a>Selector 选择器</h2><p>Scrapy提取数据有自己的一套机制，被称作选择器（selectors）,通过特定的Xpath或者CSS表达式来选择HTML文件的某个部分<br>Xpath是专门在XML文件中选择节点的语言，也可以用在HTML上。</p>
<h3 id="XPath选择器"><a href="#XPath选择器" class="headerlink" title="XPath选择器"></a>XPath选择器</h3><ul>
<li><code>nodeName</code>：选取此节点的所有节点</li>
<li><code>/</code>：从根节点选取</li>
<li><code>//</code>：从匹配选择的当前节点选择文档中的节点，不考虑它 们的位置</li>
<li><code>.</code>：选择当前节点</li>
<li><code>..</code> ：选取当前节点的父节点</li>
<li><code>@</code>：选取属性</li>
<li><code>*</code> ：匹配任何元素节点</li>
<li><code>@*</code>：匹配任何属性节点</li>
<li><code>Node()</code>：匹配任何类型的节点</li>
</ul>
<h3 id="CSS选择器"><a href="#CSS选择器" class="headerlink" title="CSS选择器"></a>CSS选择器</h3><p>CSS层叠样式表，语法由两个主要部分组成：选择器，一条或多条声明<br><code>Selector {declaration1;declaration2;……}</code></p>
<p>下面为常用的使用方法：</p>
<table>
<thead>
<tr>
<th align="left">declaration1</th>
<th align="right">declaration2</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">.class</td>
<td align="right">.color</td>
<td align="center">选择class=”color”的所有元素</td>
</tr>
<tr>
<td align="left">*</td>
<td align="right">*</td>
<td align="center">选择所有元素</td>
</tr>
<tr>
<td align="left">element</td>
<td align="right">p</td>
<td align="center">选择所有P元素</td>
</tr>
<tr>
<td align="left">element,element</td>
<td align="right">div,p</td>
<td align="center">选择所有div元素和所有p元素</td>
</tr>
<tr>
<td align="left">element,element</td>
<td align="right">div p</td>
<td align="center">选择div标签内部的所有p元素</td>
</tr>
<tr>
<td align="left">[attribute]</td>
<td align="right">[target]</td>
<td align="center">选择带有targe属性的所有元素</td>
</tr>
<tr>
<td align="left">[arrtibute=value]</td>
<td align="right">[target=_blank]</td>
<td align="center">选择target=”_blank”的所有元素</td>
</tr>
<tr>
<td align="left">id</td>
<td align="right">info</td>
<td align="center">选择id=”info”的所有元素</td>
</tr>
</tbody></table>
<h2 id="scrapy之数据项Item"><a href="#scrapy之数据项Item" class="headerlink" title="scrapy之数据项Item"></a>scrapy之数据项Item</h2><p>简单来说，就是从非结构化的数据源（web页面）提取出结构化的数据。为了定义常见的输出数据格式，Scrapy提供了Item类。Item对象是一种简单的容器，用来搜集爬取到的数据。它提供了一个类似于字典的API，具有方便的语法来声明它们的可用字段。</p>
<p>各种Scrapy组件使用Item提供的额外信息：导出器查看已声明的字段，来找出列进行导出；通过Item字段的元数据使序列化可定制；trackref跟踪Item实例来帮助查）<a href="https://docs.scrapy.org/en/latest/topics/leaks.html#topics-leaks-trackrefs" target="_blank" rel="noopener">内存泄漏</a>；等等</p>
<h3 id="声明数据项"><a href="#声明数据项" class="headerlink" title="声明数据项"></a>声明数据项</h3><pre><code>import scrapy
class A(scrapy.Item):
    name = scrapy.Filed()
    price = scrapy.Filed()
    stock = scrapy.Filed()
    last_updated = scrapy.Field(serializer=str)</code></pre><p>Field对象被用来指定每个字段的元数据。比如，上面的示例中演示了last_updated字段的序列化函数。</p>
<p>你可以为每个字段指定任何种类的元数据。Field对象接受的值是没有限制的。出于同样的原因，所有可用的元数据关键字没有引用列表。每一个在Field对象中定义的关键字，都可能会被不同的组件使用，并且仅仅只有这些组件知道这些关键字。你也可以根据你的需求，在你的项目中使用其他Field关键字。Field对象的主要目的在于，提供一种方式在某个地方来定义所有的字段元数据。通常而言，那些行为依赖于每个字段的组件使用某些字段关键字来配置该行为。你必须参考它们的文档，以查看每个组件使用哪些元数据关键字。</p>
<p>需要注意的是，用于声明Item的Field对象不会被指定为类属性。相反，可以通过<code>Item.fields</code>属性来访问它们。<br>比如用上面代码中声明的A：</p>
<pre><code>a = A(name=&quot;Gsuhy&quot;,price=100)
print(a)
-----------
{&#39;name&#39;: &#39;Gsuhy&#39;, &#39;price&#39;: 100}</code></pre><p>如果要获取字段的值，就用字典的方法访问就好了。</p>
<h2 id="数据项加载器"><a href="#数据项加载器" class="headerlink" title="数据项加载器"></a>数据项加载器</h2><p>数据项提供了一个容器，用于存储爬取到的数据。而数据项加载器提供了填充该容器的机制。<br>为了使用一个数据项加载器，首先你必须初始化它。你既可以使用类似于字典的对象（比如Item或者字典）来初始化它，也可以不使用它——在这种情况下，使用<code>ItemLoader.default_item_class</code>属性中指定的Item类，在数据项加载器构造函数中自动实例化一个Item。</p>
<p>然后，你可以在数据项加载器中收集值了，典型方式就是使用选择器<code>Selector</code>。你可以对同样的Item字段中添加不止一个值；数据项加载器自己会知道如何在以后使用适当的处理函数“连接”这些值。</p>
<pre><code>from scrapy.laoder import ItemLoader
from myproject.items import Product


def parse(self, response):
    l = ItemLoader(item=Product(), response=response)
    l.add_xpath(&#39;name&#39;, &#39;//div[@class=&quot;product_name&quot;]&#39;)
    l.add_xpath(&#39;name&#39;, &#39;//div[@class=&quot;product_title&quot;]&#39;)
    l.add_xpath(&#39;price&#39;, &#39;//p[@id=&quot;price&quot;]&#39;)
    l.add_css(&#39;stock&#39;, &#39;p#stock]&#39;)
    l.add_value(&#39;last_updated&#39;, &#39;today&#39;)  # 你也可以使用文字值
    return l.load_item()</code></pre><p>可以看到 ，name字段可以从2个不同的Xpath位置得到<br>换句话说，通过使用add_xpath()函数从两个XPath位置提取数据以便收集数据。随后，这个数据将分配给name字段。</p>
<p>然后，对price和stock字段使用类似的调用（后者使用带有<code>add_css()</code>函数的CSS选择器），最后使用不同的函数<code>add_value()</code>直接用字面值（today）填充last_updated字段。</p>
<p>最后，在收集所有数据时，将调用<code>ItemLoader.load_item()</code>函数，该函数实际返回先前调用<code>add_xpath()</code>、<code>add_css()</code>、<code>add_value()</code>函数提取和收集的数据来填充数据项。</p>

  </article>
  
    
<div class="nexmoe-post-copyright">
<i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
<strong>本文作者：</strong>Gsuhy<br>
<strong>本文链接：</strong><a href="https://www.Gsuhy.cn/2019/07/16/scrapy(一)/" title="https://www.Gsuhy.cn/2019/07/16/scrapy(一)/" target="_blank" rel="noopener">https://www.Gsuhy.cn/2019/07/16/scrapy(一)/</a><br>

  <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可

</div>


  
  <section class="nexmoe-comment">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.5.0/dist/gitalk.min.css">
<div id="gitalk"></div>
<script src="https://cdn.jsdelivr.net/npm/gitalk@1.5.0/dist/gitalk.min.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: '80b2453b6d5f37ad6225',
        clientSecret: '43e99fa852795c9a7b3eb924b2558c64b84bbdeb',
        id: window.location.pathname,
        repo: 'nexmoe.github.io',
        owner: 'nexmoe',
        admin: 'nexmoe'
    })
    gitalk.render('gitalk')
</script>
</section>
</div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/mdui@0.4.3/dist/js/mdui.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
 
    <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>


 
    <script src="https://cdn.jsdelivr.net/npm/smoothscroll-for-websites@1.4.9/SmoothScroll.min.js"></script>


<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.15.8/build/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script src="/js/app.js?v=1566921989037"></script>
<script src="https://cdn.jsdelivr.net/npm/lazysizes@5.1.0/lazysizes.min.js"></script>


    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/xtaodada/xtaodada.github.io@0.0.2/copy.js"></script>

  





</body>

</html>
